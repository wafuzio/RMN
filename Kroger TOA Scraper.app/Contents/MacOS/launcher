#!/usr/bin/env python3
"""
Kroger TOA Scraper App Launcher
This Python script serves as the main executable for the app bundle
"""

import os
import sys
import subprocess

def main():
    # Get the directory where the main Python files are located
    # The launcher is in: .../Kroger TOA Scraper.app/Contents/MacOS/launcher
    # We need to go up 4 levels to get to the project root
    current_file = os.path.abspath(__file__)
    app_bundle_dir = os.path.dirname(os.path.dirname(os.path.dirname(current_file)))  # Go up to .app
    project_dir = os.path.dirname(app_bundle_dir)  # Go up one more to project root
    
    print(f"Launcher path: {current_file}")
    print(f"Project directory: {project_dir}")
    
    # Change to the project directory
    os.chdir(project_dir)
    
    # Launch the main application
    try:
        # Import and run the main application directly
        sys.path.insert(0, project_dir)
        import keyword_input
        
        print("Starting Kroger TOA Scraper GUI...")
        import tkinter as tk
        
        print("Creating Tk root window")
        root = tk.Tk()
        print("Root window created successfully")
        
        print("Initializing KeywordInputApp")
        app = keyword_input.KeywordInputApp(root)
        print("KeywordInputApp initialized successfully")
        
        print("Starting mainloop")
        root.mainloop()
            
    except Exception as e:
        print(f"Error launching application: {e}")
        import traceback
        traceback.print_exc()
        # Fallback to subprocess launch
        subprocess.run([sys.executable, os.path.join(project_dir, "keyword_input.py")])

if __name__ == '__main__':
    main()
